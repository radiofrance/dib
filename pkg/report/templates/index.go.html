{{- define "title" -}}Report Overview | DIB{{- end -}}
{{- define "content" -}}
    {{ $opt := .Opt }}
    <h3>
        Report Overview
        <small class="text-muted">({{ $opt.GenerationDate.Format "02 Jan 06 15:04 MST" }})</small>
    </h3>
    <hr>

    <div class="accordion accordion-flush" id="report-accordion">
        {{- range $buildReport := .Data }}
            <div class="accordion-item">
                <h2 class="accordion-header" id="heading-image-{{ $buildReport.ImageName | sanitize }}">
                    <button class="accordion-button collapsed"
                            type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#collapse-image-{{ $buildReport.ImageName | sanitize }}"
                            aria-expanded="false"
                            aria-controls="collapse-image-{{ $buildReport.ImageName | sanitize }}">
                        <span>{{ $buildReport.ImageName }}&nbsp; </span>
                        {{ if and (eq $buildReport.TestsStatus 1) (eq $buildReport.BuildStatus 1) }}
                            <span class="d-inline-block bg-success rounded-circle p-1"></span>&nbsp;
                        {{ else }}
                            <span class="d-inline-block bg-danger rounded-circle p-1"></span>&nbsp;
                        {{ end }}
                    </button>
                </h2>
                <div id="collapse-image-{{ $buildReport.ImageName | sanitize }}"
                     class="accordion-collapse collapse"
                     aria-labelledby="heading-image-{{ $buildReport.ImageName | sanitize }}"
                     data-bs-parent="#report-accordion">
                    <div class="accordion-body">
                        <div>
                            <i class="fa fa-cogs" aria-hidden="true"></i>
                            <strong>Build:</strong>
                            {{ if (eq $buildReport.BuildStatus 0) }}
                                <a href="build.html#{{ $buildReport.ImageName | sanitize }}" class="link-secondary">Skipped</a>
                            {{ else if (eq $buildReport.BuildStatus 1) }}
                                <a href="build.html#{{ $buildReport.ImageName | sanitize }}" class="link-success">Success</a>
                            {{ else }}
                                <a href="build.html#{{ $buildReport.ImageName | sanitize }}"
                                   class="link-danger">Errored</a>
                            {{ end }}
                        </div>
                        {{- if $opt.WithGoss -}}
                            <div>
                                <i class="fa fa-bug" aria-hidden="true"></i>
                                <strong>Tests:</strong>
                                {{ if (eq $buildReport.TestsStatus 0) }}
                                    <a href="test.html#{{ $buildReport.ImageName | sanitize }}" class="link-secondary">Skipped</a>
                                {{ else if (eq $buildReport.TestsStatus 1) }}
                                    <a href="test.html#{{ $buildReport.ImageName | sanitize }}" class="link-success">Success</a>
                                {{ else }}
                                    <a href="test.html#{{ $buildReport.ImageName | sanitize }}" class="link-danger">Errored</a>
                                {{ end }}
                            </div>
                        {{ end }}
                        <div>
                            {{ if $buildReport.FailureMessage }}
                                <i class="fa fa-code" aria-hidden="true"></i>
                                <strong>Failure Message:</strong> {{ $buildReport.FailureMessage }}
                            {{ end }}
                        </div>
                    </div>
                </div>
            </div>
        {{- end }}
    </div>
{{- end -}}
